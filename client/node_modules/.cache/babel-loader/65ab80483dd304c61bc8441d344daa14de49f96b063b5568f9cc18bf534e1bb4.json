{"ast":null,"code":"var _jsxFileName = \"E:\\\\Project\\\\animal-rescue-adoption-platform\\\\client\\\\src\\\\context\\\\CartContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useMemo, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CartCtx = /*#__PURE__*/createContext();\nexport function CartProvider({\n  children\n}) {\n  _s();\n  const [items, setItems] = useState(() => {\n    try {\n      return JSON.parse(localStorage.getItem('cart') || '[]');\n    } catch {\n      return [];\n    }\n  });\n  const persist = nextOrFn => {\n    const next = typeof nextOrFn === 'function' ? nextOrFn(items) : nextOrFn;\n    setItems(next);\n    localStorage.setItem('cart', JSON.stringify(next));\n  };\n  const add = (product, qty = 1) => {\n    if (product !== null && product !== void 0 && product.isSold) {\n      // Do not add sold items\n      return;\n    }\n    persist(() => {\n      const existing = items.find(i => i._id === product._id);\n      if (existing) {\n        return items.map(i => i._id === product._id ? {\n          ...i,\n          quantity: (i.quantity || 1) + qty\n        } : i);\n      }\n      return [...items, {\n        ...product,\n        quantity: qty\n      }];\n    });\n  };\n  const remove = id => persist(items.filter(i => i._id !== id));\n  const clear = () => persist([]);\n  const setQuantity = (id, qty) => persist(items.map(i => i._id === id ? {\n    ...i,\n    quantity: qty\n  } : i));\n  const totals = useMemo(() => {\n    const toNum = s => {\n      const n = Number(String(s).replace(/[^0-9.]/g, ''));\n      return isNaN(n) ? 0 : n;\n    };\n    const subtotal = items.reduce((sum, it) => sum + toNum(it.amount) * (it.quantity || 1), 0);\n    return {\n      subtotal\n    };\n  }, [items]);\n  const value = {\n    items,\n    add,\n    remove,\n    clear,\n    setQuantity,\n    totals\n  };\n  return /*#__PURE__*/_jsxDEV(CartCtx.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 48,\n    columnNumber: 10\n  }, this);\n}\n_s(CartProvider, \"1WEGwgZbV6tz5fZJNILv8U3A43w=\");\n_c = CartProvider;\nexport const useCart = () => {\n  _s2();\n  return useContext(CartCtx);\n};\n_s2(useCart, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useContext","useMemo","useState","jsxDEV","_jsxDEV","CartCtx","CartProvider","children","_s","items","setItems","JSON","parse","localStorage","getItem","persist","nextOrFn","next","setItem","stringify","add","product","qty","isSold","existing","find","i","_id","map","quantity","remove","id","filter","clear","setQuantity","totals","toNum","s","n","Number","String","replace","isNaN","subtotal","reduce","sum","it","amount","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useCart","_s2","$RefreshReg$"],"sources":["E:/Project/animal-rescue-adoption-platform/client/src/context/CartContext.js"],"sourcesContent":["import React, { createContext, useContext, useMemo, useState } from 'react';\r\n\r\nconst CartCtx = createContext();\r\n\r\nexport function CartProvider({ children }) {\r\n  const [items, setItems] = useState(() => {\r\n    try {\r\n      return JSON.parse(localStorage.getItem('cart') || '[]');\r\n    } catch {\r\n      return [];\r\n    }\r\n  });\r\n\r\n  const persist = (nextOrFn) => {\r\n    const next = typeof nextOrFn === 'function' ? nextOrFn(items) : nextOrFn;\r\n    setItems(next);\r\n    localStorage.setItem('cart', JSON.stringify(next));\r\n  };\r\n\r\n  const add = (product, qty = 1) => {\r\n    if (product?.isSold) {\r\n      // Do not add sold items\r\n      return;\r\n    }\r\n    persist(() => {\r\n      const existing = items.find((i) => i._id === product._id);\r\n      if (existing) {\r\n        return items.map((i) => (i._id === product._id ? { ...i, quantity: (i.quantity || 1) + qty } : i));\r\n      }\r\n      return [...items, { ...product, quantity: qty }];\r\n    });\r\n  };\r\n\r\n  const remove = (id) => persist(items.filter((i) => i._id !== id));\r\n  const clear = () => persist([]);\r\n  const setQuantity = (id, qty) => persist(items.map((i) => (i._id === id ? { ...i, quantity: qty } : i)));\r\n\r\n  const totals = useMemo(() => {\r\n    const toNum = (s) => {\r\n      const n = Number(String(s).replace(/[^0-9.]/g, ''));\r\n      return isNaN(n) ? 0 : n;\r\n    };\r\n    const subtotal = items.reduce((sum, it) => sum + toNum(it.amount) * (it.quantity || 1), 0);\r\n    return { subtotal };\r\n  }, [items]);\r\n\r\n  const value = { items, add, remove, clear, setQuantity, totals };\r\n  return <CartCtx.Provider value={value}>{children}</CartCtx.Provider>;\r\n}\r\n\r\nexport const useCart = () => useContext(CartCtx);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}